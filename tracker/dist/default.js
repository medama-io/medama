(function(){if(document){var e=document.currentScript,f=e.getAttribute("data-api")?`${document.location.protocol}//${e.getAttribute("data-api")}`:e.src.replace(/[^\/]+$/,"api/"),p=()=>Date.now().toString(36)+Math.random().toString(36).substr(2),h=p(),k=!0,q=!0,g=0,l=Date.now(),m=!1,t=history.pushState,u=history.replaceState,r=a=>new Promise(v=>{const b=new XMLHttpRequest;b.onload=()=>{v(0==b.responseText)};b.open("GET",a);b.setRequestHeader("Content-Type","text/plain");b.send()}),n=()=>{k=!1;h=p();
g=0;l=Date.now();m=!1},c=()=>{r(f+"event/ping?u="+encodeURIComponent(location.host+location.pathname)).then(a=>{q=a;navigator.sendBeacon(f+"event/hit",JSON.stringify({b:h,e:"load",u:location.href,r:document.referrer,p:k,q,t:Intl.DateTimeFormat().resolvedOptions().timeZone}))})},d=()=>{m||navigator.sendBeacon(f+"event/hit",JSON.stringify({b:h,e:"unload",m:Date.now()-l}));m=!0};"onpagehide"in self?document.addEventListener("pagehide",()=>{d()},{capture:!0}):(document.addEventListener("beforeunload",
()=>{d()},{capture:!0}),document.addEventListener("unload",()=>{d()},{capture:!0}));document.addEventListener("visibilitychange",()=>{"hidden"==document.visibilityState?g=Date.now():(l+=Date.now()-g,g=0)},{capture:!0});r(f+"event/ping").then(a=>{k=a;c();e.getAttribute("data-hash")?document.addEventListener("hashchange",()=>{c()},{capture:!0}):(history.pushState=function(){d();n();t.apply(history,arguments);c()},history.replaceState=function(){d();n();u.apply(history,arguments);c()},window.addEventListener("popstate",
()=>{n();c()},{capture:!0}))})}})();
