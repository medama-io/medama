(function(){if(document){var c=document.currentScript,d=c.getAttribute("data-api")?`${document.location.protocol}//${c.getAttribute("data-api")}`:c.src.replace(/[^\/]+$/,"api/"),n=()=>Date.now().toString(36)+Math.random().toString(36).substr(2),h=n(),k=!0,p=!0,e=0,l=Date.now(),m=!1,w=history.pushState,x=history.replaceState,q=()=>{k=!1;h=n();e=0;l=Date.now();m=!1},u=a=>function(r,b,t){t&&location.pathname!==(new URL(t,location.href)).pathname?(f(),q(),a.apply(this,arguments),g()):a.apply(this,arguments)},
v=a=>new Promise(r=>{const b=new XMLHttpRequest;b.onload=()=>{r(0==b.responseText)};b.open("GET",a);b.setRequestHeader("Content-Type","text/plain");b.send()}),g=()=>{v(d+"event/ping?u="+encodeURIComponent(location.host+location.pathname)).then(a=>{p=a;navigator.sendBeacon(d+"event/hit",JSON.stringify({b:h,e:"load",u:location.href,r:document.referrer,p:k,q:p,t:Intl.DateTimeFormat().resolvedOptions().timeZone}))})},f=()=>{m||navigator.sendBeacon(d+"event/hit",JSON.stringify({b:h,e:"unload",m:Date.now()-
l}));m=!0};"onpagehide"in self?document.addEventListener("pagehide",()=>{f()},{capture:!0}):(document.addEventListener("beforeunload",()=>{f()},{capture:!0}),document.addEventListener("unload",()=>{f()},{capture:!0}));document.addEventListener("visibilitychange",()=>{"hidden"==document.visibilityState?e=Date.now():(l+=Date.now()-e,e=0)},{capture:!0});v(d+"event/ping").then(a=>{k=a;g();c.getAttribute("data-hash")?document.addEventListener("hashchange",()=>{g()},{capture:!0}):(history.pushState=u(w),
history.replaceState=u(x),window.addEventListener("popstate",()=>{q();g()},{capture:!0}))})}})();
