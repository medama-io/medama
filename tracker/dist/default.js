(function(){if(document){var c=document.currentScript,d=c.getAttribute("data-api")?`${document.location.protocol}//${c.getAttribute("data-api")}`:c.src.replace(/[^\/]+$/,"api/"),p=()=>Date.now().toString(36)+Math.random().toString(36).substr(2),k=p(),l=!0,q=!0,e=0,m=Date.now(),n=!1,x=history.pushState,y=history.replaceState,r=()=>{l=!1;k=p();e=0;m=Date.now();n=!1},t=a=>a.toString().split("?")[0],z=(a,f)=>t(a)===t(f),v=a=>function(f,b,u){u&&!z(location.href,u)?(g(),r(),a.apply(this,arguments),h()):
a.apply(this,arguments)},w=a=>new Promise(f=>{const b=new XMLHttpRequest;b.onload=()=>{f(0==b.responseText)};b.open("GET",a);b.setRequestHeader("Content-Type","text/plain");b.send()}),h=()=>{w(d+"event/ping?u="+encodeURIComponent(location.host+location.pathname)).then(a=>{q=a;navigator.sendBeacon(d+"event/hit",JSON.stringify({b:k,e:"load",u:location.href,r:document.referrer,p:l,q,t:Intl.DateTimeFormat().resolvedOptions().timeZone}))})},g=()=>{n||navigator.sendBeacon(d+"event/hit",JSON.stringify({b:k,
e:"unload",m:Date.now()-m}));n=!0};"onpagehide"in self?document.addEventListener("pagehide",()=>{g()},{capture:!0}):(document.addEventListener("beforeunload",()=>{g()},{capture:!0}),document.addEventListener("unload",()=>{g()},{capture:!0}));document.addEventListener("visibilitychange",()=>{"hidden"==document.visibilityState?e=Date.now():(m+=Date.now()-e,e=0)},{capture:!0});w(d+"event/ping").then(a=>{l=a;h();c.getAttribute("data-hash")?document.addEventListener("hashchange",()=>{h()},{capture:!0}):
(history.pushState=v(x),history.replaceState=v(y),window.addEventListener("popstate",()=>{r();h()},{capture:!0}))})}})();
