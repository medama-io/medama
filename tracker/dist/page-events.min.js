!function(){if(!document)return;const t=document.currentScript,e=t.getAttribute("data-api")?`${location.protocol}//${t.getAttribute("data-api")}`:t.src.replace(/[^\/]+$/,"api/"),n=()=>Date.now().toString(36)+Math.random().toString(36).substr(2);let a=n(),o=!0,r=0,i=Date.now(),d=!1;const s=history.pushState,c=history.replaceState,p=()=>{o=!1,a=n(),r=0,i=Date.now(),d=!1},u=t=>function(e,n,a){a&&location.pathname!==new URL(a,location.href).pathname?(g(),p(),t.apply(this,arguments),m()):t.apply(this,arguments)},l=t=>[...document.querySelectorAll(`[data-m\\:${t}]`)].reduce(((e,n)=>{return{...e,...(a=n,o="data-m:"+t,(a.getAttribute(o)||"").split(";").reduce(((t,e)=>{const[n,a]=e.split("=").map((t=>t.trim()));return n&&a&&(t[n]=a),t}),{}))};var a,o}),{}),h=t=>new Promise((e=>{const n=new XMLHttpRequest;n.onload=()=>{e(0==n.responseText)},n.open("GET",t),n.setRequestHeader("Content-Type","text/plain"),n.send()})),m=async()=>{h(e+"event/ping?u="+encodeURIComponent(location.host+location.pathname)).then((t=>{fetch(e+"event/hit",{method:"POST",body:JSON.stringify({b:a,e:"load",u:location.href,r:document.referrer,p:o,q:t,t:Intl.DateTimeFormat().resolvedOptions().timeZone,d:l("load")}),mode:"no-cors"})}))},g=()=>{d||navigator.sendBeacon(e+"event/hit",JSON.stringify({b:a,e:"unload",m:Date.now()-i,d:l("unload")})),d=!0};"onpagehide"in self?addEventListener("pagehide",g,{capture:!0}):(addEventListener("beforeunload",g,{capture:!0}),addEventListener("unload",g,{capture:!0})),addEventListener("visibilitychange",(()=>{"hidden"==document.visibilityState?r=Date.now():(i+=Date.now()-r,r=0)}),{capture:!0}),h(e+"event/ping?root").then((e=>{o=e,m(),t.getAttribute("data-hash")?addEventListener("hashchange",m,{capture:!0}):(history.pushState=u(s),history.replaceState=u(c),addEventListener("popstate",(()=>{g(),p(),m()}),{capture:!0}))}))}();